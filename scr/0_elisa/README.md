<!-- PROJECT LOGO -->
<br />
<div align="center">
  <h3 align="center">ELISA processing pipeline</h3>
  
  <a href="https://github.com/chandranlab/filo_GP-bat_NPC1/blob/main/img/curves.png">
    <img src="/img/curves.png" alt="Logo" width="400">
  </a>
  
  <p align="center">
    A python code for the automatic processing of ELISA experiments
    <br />
    <a href="https://github.com/chandranlab/filo_GP-bat_NPC1"><strong>Back to Main»</strong></a>
    <br />
    <br />
    ·
    <a href="https://github.com/chandranlab/filo_GP-bat_NPC1/issues">Report Bug</a>
    ·
    <a href="https://github.com/chandranlab/filo_GP-bat_NPC1/issues">Request Feature</a>
  </p>
</div>

<!-- ########################################################################################## -->

<!-- GETTING STARTED -->

## Getting Started

### Prerequisites

 Python version: 3.8.2

 Packages

|Package         | Version  |
|----------------|:--------:|
|pandas          | 1.2.3    |
|lmfit           | 1.0.2    |
|matplotlib      | 3.4.1    |
|numpy           | 1.20.2   |
|scipy           | 1.6.2    |
|scikit-learn    | 0.24.1   |
|openpyxl        | 3.0.7    |
|pybroom         | 0.2      |
|XlsxWriter      |  1.3.8   |

### Installation

1. Clone the repository (<a href="https://docs.github.com/en/repositories/creating-and-managing-repositories/cloning-a-repository">howto</a>)
2. Create conda environment
   ```sh
   conda env create -f environment_elisa.yml
   ```
3. Activate conda environment
   ```sh
   conda activate elisa2
   ```
4. Run
   ```sh
   python run_multiple_elisas.py
   ```

<p align="right">(<a href="#readme-top">back to top</a>)</p>

<!-- ########################################################################################## -->

<!-- INPUT -->

## Input files
The algorithm requires three sets of inputs:
* Cytation file(s) with labels. Excel files generated by the cytation files and edited to include the concentration of the substrate and labels for each sample (e.g. 01092020_BOMV_ELISA_B1-B28.xlsx & 01162020_BOMV_ELISA_B29-B50.xlsx)
* format_NPC1.txt: Format file specifying what is what in the cytation files. Excel coordinates (row number / column letter) are necessary to describe the location of the experimental data, positive and negative controls, and blanks. It is is necessary to specify the coordinates for the cells corresponding to the experimental readouts ("readout"), the substrate concentration ("concentration"), and labels ("name") 
* input_master.txt: File describing the inputs, output and processing options

<!-- ########################################################################################## -->

<!-- OUTPUT -->
## output files
The output here is based on the input of two ELISA binding experiments (input/01092020_BOMV_ELISA_B1-B28.xlsx & input/1162020_BOMV_ELISA_B29-B50.xlsx)
* all_fitted_curves.png: Fitted sigmoidals curves altogether
* all_predicted_readouts.csv: Inferred readouts based on the fitted sigmoidal curves
* all_together_concat.xlsx: Concatenation of all ELISA binding experiments (processed)
* auc.txt: Area-Under-the-Curve of the fitted sigmoidals
* curve_fit_cons.txt: Sigmoidal parameters if curve_fit is constrained (not the case here)
* curve_fit.txt: Sigmoidal parameters of each fitted sigmoidal curve (min, max, ec50, hill coefficient)
* ec10.txt: EC10 of fitted sigmoidal curves
* ec50.txt: EC50 of fitted sigmoidal curves
* ec90.txt: EC00 of fitted sigmoidal curves
* processing.log: log file
* BOMV directory: Raw and processed (denoised and normalized) data from the ELISA binding experiments (input/01092020_BOMV_ELISA_B1-B28.xlsx & input/1162020_BOMV_ELISA_B29-B50.xlsx). Plots for each individual GP:NPC1 pair are also included (raw, denoised and normalized readouts; sigmoidal curve fit and; residual plots)